<?xml version="1.0" encoding="utf-8"?>
<odoo>

    <record id="paperformat_rubber_salary" model="report.paperformat">
      <field name="name">A4 Portrait</field>
      <field name="format">A4</field>
      <field name="orientation">Portrait</field>
      <field name="margin_top">10</field>
      <field name="margin_bottom">2</field>
      <field name="margin_left">10</field>
      <field name="margin_right">10</field>
      <field name="header_line" eval="False" />
      <field name="header_spacing">20</field>
      <field name="dpi">90</field>
    </record>   

    <record id="action_rubber_salary_report" model="ir.actions.report">
      <field name="name">In Phiếu Lương</field>
      <field name="model">rubber.salary</field>
      <field name="report_type">qweb-pdf</field>
      <field name="report_name">caosu.rubber_salary_template</field>
      <field name="binding_model_id" ref="model_rubber_salary" />
      <field name="binding_type">report</field>
      <field name="paperformat_id" ref="paperformat_rubber_salary" />
    </record>
    
    <template id="rubber_salary_template">
      <t t-call="web.html_container">
        <t t-call="web.internal_layout">
          <div class="page" style="font-family:arial; font-size: 14.9px;">
            <!-- Report header content -->
            <t t-foreach="docs" t-as="o">
              <p style="page-break-before:always;"> </p>
              <div class="row">
                <div class="col-6">
                  <h4>Phiếu lương tháng <span style="font-weight: bold" t-field="o.thang" /> năm <span t-field="o.nam" /></h4>
                </div>
                <div class="col-3"><h4>CN: <span style="font-weight: bold" t-field="o.sttcn" /> <span style="font-weight: bold" t-field="o.empname" /></h4></div>
                <div class="col-3"><h4><span t-field="o.to_name1" /></h4></div>
              </div>
              <br></br>
              <div class="row">
                <table width="100%">
                  <thead>
                    <tr style="text-align: center; border: 1px solid black; border-collapse: collapse;">
                        <th style="border-right-style: solid; padding-left: 12px; padding-right: 12px;">Ngày</th>
                        <th style="border-right-style: solid; padding-left: 2px; padding-right: 2px;">Lô</th>
                        <th style="border-right-style: solid; padding-left: 14px; padding-right: 7px;">Mũ</th>
                        <th style="border-right-style: solid; padding-left: 7px; padding-right: 14px;">Độ</th>
                        <th style="border-right-style: solid;">Quy khô</th>
                        <th style="border-right-style: solid;">ĐG nước</th>
                        <th style="text-align: right; padding-right: 10px; border-right-style: solid;">Tiền nước</th>
                        <th t-if="o.tientangdg > 0" style="border-right-style: solid;">ĐG tăng</th>
                        <th t-if="o.tientangdg > 0" style="text-align: right; padding-right: 10px; border-right-style: solid;">Tiền tăng DG</th>
                        <th t-if="o.tienday > 0" style="border-right-style: solid; padding-left: 2px; padding-right: 2px;">Dây</th>
                        <th t-if="o.tienday > 0" style="border-right-style: solid; padding-left: 2px; padding-right: 2px;">Giá dây</th>
                        <th t-if="o.tienday > 0" style="text-align: right; padding-right: 10px; border-right-style: solid;">Tiền dây</th>
                        <th t-if="o.tiendong > 0" style="border-right-style: solid;">Đông</th>
                        <th t-if="o.tiendong > 0" style="border-right-style: solid;">Giá đông</th>
                        <th t-if="o.tiendong > 0" style="text-align: right; padding-right: 10px; border-right-style: solid;">Tiền đông</th>
                        <th t-if="o.tienchen > 0" style="border-right-style: solid; padding-left: 2px; padding-right: 2px;">Chén</th>
                        <th t-if="o.tienchen > 0" style="border-right-style: solid;">Giá chén</th>
                        <th t-if="o.tienchen > 0" style="text-align: right; padding-right: 10px; border-right-style: solid;">Tiền chén</th>
                        <th t-if="o.phucap1 > 0" style="text-align: right; padding-right: 10px; border-right-style: solid;">Phụ cấp</th>
                        <th style="text-align: right; padding-right: 10px; border-right-style: solid;">Tổng tiền</th>
                    </tr>
                  </thead>
                  <tbody>
                    <t t-foreach="o.rubber_line_ids.sorted(key=lambda record: record.ngay, reverse=False)" t-as="line">
                      <tr style="text-align: center;border: 1px solid black; border-collapse: collapse;">
                        <td style="border-right-style: solid;">
                          <span t-field="line.ngay"/>
                        </td>
                        <td style="border-right-style: solid;">
                          <span t-field="line.lo"/>
                        </td>
                        <td style="border-right-style: solid;">
                          <span t-esc="'%.1f'% line.cong"/>
                        </td>
                        <td style="border-right-style: solid;">
                          <span t-if="line.do_phancay > 0" t-esc="'%.1f'% line.do_phancay"/><span t-if="line.do_phancay == 0">-</span>
                        </td>
                        <td style="border-right-style: solid;">
                          <span t-if="line.quykho > 0" t-esc="'%.1f'% line.quykho"/><span t-if="line.quykho == 0">-</span>
                        </td>
                        <td style="text-align: center; border-right-style: solid;">
                          <span t-if="line.dongia_nuoc > 0" t-field="line.dongia_nuoc"/><span t-if="line.dongia_nuoc == 0">-</span>
                        </td>
                        <td style="text-align: right; padding-right: 10px; border-right-style: solid;">
                          <span t-if="line.tiennuoc > 0" t-field="line.tiennuoc"/><span t-if="line.tiennuoc == 0">-</span>
                        </td>
                        <td t-if="o.tientangdg > 0" style="border-right-style: solid;">
                          <span t-if="line.dongia_tang > 0" t-field="line.dongia_tang"/><span t-if="line.dongia_tang == 0">-</span>
                        </td>
                        <td t-if="o.tientangdg > 0" style="text-align: right; padding-right: 10px; border-right-style: solid;">
                          <span t-if="line.tientangdg > 0" t-field="line.tientangdg"/><span t-if="line.tientangdg == 0">-</span>
                        </td>
                        <td t-if="o.tienday > 0" style="border-right-style: solid;">
                          <span t-if="line.muday > 0" t-esc="'%.1f'% line.muday"/><span t-if="line.muday == 0">-</span>
                        </td>
                        <td t-if="o.tienday > 0" style="border-right-style: solid;">
                          <span t-if="line.dongia_day > 0" t-field="line.dongia_day"/><span t-if="line.dongia_day == 0">-</span>
                        </td>
                        <td t-if="o.tienday > 0" style="text-align: right; padding-right: 10px; border-right-style: solid;">
                          <span t-if="line.tienday > 0" t-field="line.tienday"/><span t-if="line.tienday == 0">-</span>
                        </td>
                        <td t-if="o.tiendong > 0" style="text-align: right; padding-right: 10px; border-right-style: solid;">
                          <span t-if="line.mudong > 0" t-esc="'%.1f'% line.mudong"/><span t-if="line.mudong == 0">-</span>
                        </td>
                        <td t-if="o.tiendong > 0" style="border-right-style: solid;">
                          <span t-if="line.dongia_dong > 0" t-field="line.dongia_dong"/><span t-if="line.dongia_dong == 0">-</span>
                        </td>
                        <td t-if="o.tiendong > 0" style="border-right-style: solid;">
                          <span t-if="line.tiendong > 0" t-field="line.tiendong"/><span t-if="line.tiendong == 0">-</span>
                        </td>
                        <td t-if="o.tienchen > 0" style="border-right-style: solid;">
                          <span t-if="line.muchen > 0" t-esc="'%.1f'% line.muchen"/><span t-if="line.muchen == 0">-</span>
                        </td>
                        <td t-if="o.tienchen > 0" style="border-right-style: solid;">
                          <span t-if="line.dongia_chen > 0" t-field="line.dongia_chen"/><span t-if="line.dongia_chen == 0">-</span>
                        </td>
                        <td t-if="o.tienchen > 0" style="text-align: right; padding-right: 10px; border-right-style: solid;">
                          <span t-if="line.tienchen > 0" t-field="line.tienchen"/><span t-if="line.tienchen == 0">-</span>
                        </td>
                        <td t-if="o.phucap1 > 0" style="text-align: right; padding-right: 10px; border-right-style: solid;">
                          <span t-if="line.phucap > 0" t-field="line.phucap"/><span t-if="line.phucap == 0">-</span>
                        </td>
                        <td style="text-align: right; padding-right: 10px;">
                          <span t-if="line.tongtien > 0" t-field="line.tongtien"/><span t-if="line.tongtien == 0">-</span>
                        </td>
                      </tr>
                    </t>
                    <tr>
                        <td style="border: 0.5px solid black; text-align: center; font-weight: bold;">
                          <span t-field="o.ngaycao"/>
                        </td>
                        <td style="border: 0.5px solid black;"></td>
                        <td style="border: 0.5px solid black;"></td>
                        <td style="border: 0.5px solid black;"></td>
                        <td style="border: 0.5px solid black; text-align: center; font-weight: bold;">
                          <span t-esc="'{0:,.0f}'.format(sum(line.quykho for line in o.rubber_line_ids))"/>                            
                        </td>                        
                        <td style="border: 0.5px solid black;"></td>
                        <td style="border: 0.5px solid black; text-align: right; padding-right: 10px; font-weight: bold;">                            
                          <span t-esc="'{0:,.0f}'.format(sum(line.tiennuoc for line in o.rubber_line_ids))"/>                           
                        </td>
                        <td style="border: 0.5px solid black;"></td>
                        <td style="border: 0.5px solid black; text-align: right; padding-right: 10px; font-weight: bold;">                            
                          <span t-esc="'{0:,.0f}'.format(sum(line.tientangdg for line in o.rubber_line_ids))"/>                           
                        </td>
                        <td style="border: 0.5px solid black; text-align: right; padding-right: 10px; font-weight: bold;">                            
                          <span t-esc="'{0:,.0f}'.format(sum(line.tongtien for line in o.rubber_line_ids))"/>                           
                        </td>                         
                    </tr> 
                    
                  </tbody>
                  
                </table>
              </div>
              <div style="height: 40px;"></div>
              <div class="row">
                <div class="col-6">
                  <table width="100%">
                    <tr>
                      <td width="50%">Số phần</td>
                      <td><span t-esc="'%.1f'% o.sophan"/></td>
                    </tr>
                    <tr>
                      <td>Quy khô 1 phần</td>
                      <td><span t-esc="'%.1f'% o.quykho1"/></td>
                    </tr>
                    <tr>
                      <td>Số ngày vắng</td>
                      <td><span t-field="o.ngaylam"/></td>
                    </tr>
                    <tr>
                      <td style="font-weight: bold;">Lương sản phẩm</td>
                      <td style="font-weight: bold;"><span t-field="o.tongtien" t-options="{'widget': 'monetary', 'display_currency': o.currency_id}"/></td>
                    </tr>
                    <tr t-if="o.boithuoc != 0">
                      <td>Bôi thuốc</td>
                      <td><span t-field="o.boithuoc"/></td>
                    </tr>
                    <tr t-if="o.boikeo != 0">
                      <td>Bôi keo</td>
                      <td><span t-field="o.boikeo"/></td>
                    </tr>
                    <tr t-if="o.giacomang != 0">
                      <td>Gia cố máng</td>
                      <td><span t-field="o.giacomang"/></td>
                    </tr>
                    <tr t-if="o.chuyencan != 0">
                      <td>Chuyên cần</td>
                      <td><span t-field="o.chuyencan"/></td>
                    </tr>
                    <tr t-if="o.thuongsl != 0">
                      <td>Thưởng sản lượng</td>
                      <td><span t-field="o.thuongsl"/></td>
                    </tr>
                    <tr t-if="o.caochoang != 0">
                      <td>Cạo choàng</td>
                      <td><span t-field="o.caochoang"/></td>
                    </tr>
                    <tr t-if="o.itmu != 0">
                      <td>Ít mũ</td>
                      <td><span t-field="o.itmu"/></td>
                    </tr>
                    <tr t-if="o.duongxau != 0">
                      <td>Đường xấu</td>
                      <td><span t-field="o.duongxau"/></td>
                    </tr>
                    <tr t-if="o.tienphan != 0">
                      <td>Tiền phân</td>
                      <td><span t-field="o.tienphan"/></td>
                    </tr>
                    <tr t-if="o.mmcn != 0">
                      <td>Mở miệng cạo ngửa</td>
                      <td><span t-field="o.mmcn"/></td>
                    </tr>
                    <tr t-if="o.mmcu != 0">
                      <td>Mở miệng cạo úp</td>
                      <td><span t-field="o.mmcu"/></td>
                    </tr>
                    <tr t-if="o.bkrtgn != 0">
                      <td>Buộc kiềng, rãi tô, gắn nắp</td>
                      <td><span t-field="o.bkrtgn"/></td>
                    </tr>
                    <tr t-if="o.rmdm != 0">
                      <td>Rong mương, đóng máng</td>
                      <td><span t-field="o.rmdm"/></td>
                    </tr>
                    <tr t-if="o.rct != 0">
                      <td>Rập cờ, thước</td>
                      <td><span t-field="o.rct"/></td>
                    </tr>
                    <tr t-if="o.bkrtmn != 0">
                      <td>Buộc kiềng, rãi tô, miệng ngửa</td>
                      <td><span t-field="o.bkrtmn"/></td>
                    </tr>
                    <tr t-if="o.phucap != 0">
                      <td>Tiền phụ cấp</td>
                      <td><span t-field="o.phucap"/></td>
                    </tr>
                    <tr t-if="o.xdn != 0">
                      <td>Xỏ dây nắp</td>
                      <td><span t-field="o.xdn"/></td>
                    </tr>
                    <tr t-if="o.tienvattu != 0">
                      <td>Tiền gom tô, nắp kiềng, váy</td>
                      <td><span t-field="o.tienvattu"/></td>
                    </tr>
                    <tr t-if="o.ttmang != 0">
                      <td>Tiền máng</td>
                      <td><span t-field="o.ttmang"/></td>
                    </tr>
                    <tr t-if="o.caoxa != 0">
                      <td>Cạo xả</td>
                      <td><span t-field="o.caoxa"/></td>
                    </tr>
                    <tr t-if="o.bddm != 0">
                      <td>Bắn dây dẫn mũ</td>
                      <td><span t-field="o.bddm"/></td>
                    </tr>
                    <tr t-if="o.bdgv != 0">
                      <td>Buộc đá, gắn váy</td>
                      <td><span t-field="o.bdgv"/></td>
                    </tr>
                    <tr t-if="o.bdgvmu != 0">
                      <td>Buộc đá, gắn váy miệng úp</td>
                      <td><span t-field="o.bdgvmu"/></td>
                    </tr>
                    <tr t-if="o.luongthangtruoc != 0">
                      <td>Lương tháng trước</td>
                      <td><span t-field="o.luongthangtruoc"/></td>
                    </tr>
                    <tr t-if="o.rutbot != 0">
                      <td>Tiền rút phúc lợi</td>
                      <td><span t-field="o.rutbot"/></td>
                    </tr>
                    <tr t-if="o.dongthem != 0">
                      <td>Đóng thêm phúc lợi</td>
                      <td><span t-field="o.dongthem"/></td>
                    </tr>
                    <tr t-if="o.ruttt != 0">
                      <td>Rút tiền thưởng</td>
                      <td><span t-field="o.ruttt"/></td>
                    </tr>
                    <tr>
                      <td style="border-top-style: solid; border-width: 1px; font-weight: bold;">Tổng lương</td>
                      <td style="border-top-style: solid; border-width: 1px; font-weight: bold;"><span t-field="o.tongluong" t-options="{'widget': 'monetary', 'display_currency': o.currency_id}"/></td>
                    </tr>
                    <tr t-if="o.tienvattu1 != 0">
                      <td>Tiền giữ vật tư</td>
                      <td><span t-field="o.tienvattu1"/></td>
                    </tr>
                    <tr t-if="o.tbm != 0">
                      <td>Tiền bấm máng</td>
                      <td><span t-field="o.tbm"/></td>
                    </tr>
                    <tr t-if="o.tienmuon != 0">
                      <td>Tiền mượn</td>
                      <td><span t-field="o.tienmuon"/></td>
                    </tr>
                    <tr t-if="o.tiencuoinam != 0">
                      <td>Tiền gửi xe máy</td>
                      <td><span t-field="o.tiencuoinam"/></td>
                    </tr>
                    <tr t-if="o.tienung != 0">
                      <td>Tiền ứng</td>
                      <td><span t-field="o.tienung"/></td>
                    </tr>
                    <tr t-if="o.tiendao != 0">
                      <td>Tiền dao</td>
                      <td><span t-field="o.tiendao"/></td>
                    </tr>
                    <tr t-if="o.chiendo != 0">
                      <td>Chiên độ</td>
                      <td><span t-field="o.chiendo"/></td>
                    </tr>
                    <tr t-if="o.tiengomto != 0">
                      <td>Tiền giữ gom tô</td>
                      <td><span t-field="o.tiengomto"/></td>
                    </tr>
                    <tr t-if="o.tamvong != 0">
                      <td>Tầm vong</td>
                      <td><span t-field="o.tamvong"/></td>
                    </tr>
                    <tr t-if="o.truidao != 0">
                      <td>Trui dao</td>
                      <td><span t-field="o.truidao"/></td>
                    </tr>
                    <tr t-if="o.bandao != 0">
                      <td>Bán dao</td>
                      <td><span t-field="o.bandao"/></td>
                    </tr>
                    <tr t-if="o.banlinhtinh != 0">
                      <td>Bán vật tư</td>
                      <td><span t-field="o.banlinhtinh"/></td>
                    </tr>
                    <tr t-if="o.tienbh != 0">
                      <td>Tiền BH</td>
                      <td><span t-field="o.tienbh"/></td>
                    </tr>
                    <tr>
                      <td style="font-weight: bold;">Còn lại</td>
                      <td style="font-weight: bold;"><span t-field="o.conlai" t-options="{'widget': 'monetary', 'display_currency': o.currency_id}"/></td>
                    </tr>
                    <tr>
                      <td style="border-top-style: solid; border-width: 1px; font-weight: bold;">Còn lại làm tròn</td>
                      <td style="border-top-style: solid; border-width: 1px; font-weight: bold;"><span t-field="o.tongtienr" t-options="{'widget': 'monetary', 'display_currency': o.currency_id}"/></td>
                    </tr>
                    <tr>
                      <td>Ghi chú</td>
                      <td><span t-field="o.ghichu"/></td>
                    </tr>
                  </table>
                </div>               
                <div class="col-6">
                  <table width="100%">
                    <thead>
                      <tr>
                        <th colspan="6" style="text-align: center;font-size: 16px">TIỀN THƯỞNG VÀ PHÚC LỢI</th>                                                
                      </tr>
                      <tr><th colspan="6" style="height: 20px;"></th></tr>
                      <tr>
                        <th style="border: 0.5px solid black; text-align: center; font-weight: bold;"><span t-esc="o.reward_line_ids._fields['thang'].string"/></th>
                        <th style="border: 0.5px solid black; text-align: right; padding-right: 10px; font-weight: bold;"><span t-esc="o.reward_line_ids._fields['phucloi'].string"/></th>
                        <th style="border: 0.5px solid black; text-align: right; padding-right: 10px; font-weight: bold;"><span t-esc="o.reward_line_ids._fields['phucloitl'].string"/></th>
                        <th style="border: 0.5px solid black; text-align: right; padding-right: 10px; font-weight: bold;"><span t-esc="o.reward_line_ids._fields['tongtien'].string"/></th>                        
                      </tr>
                    </thead>
                    <tbody>
                      <t t-foreach="o.reward_line_ids" t-as="line">                        
                        <tr>
                          <th style="border: 0.5px solid black; text-align: center; font-weight: normal;"><span t-field="line.thang"/></th>
                          <th style="border: 0.5px solid black; text-align: right; padding-right: 10px; font-weight: normal;"><span t-if="line.phucloi > 0" t-field="line.phucloi"/><span t-if="line.phucloi == 0">-</span></th>
                          <th style="border: 0.5px solid black; text-align: right; padding-right: 10px; font-weight: normal;"><span t-if="line.phucloitl > 0" t-field="line.phucloitl"/><span t-if="line.phucloitl == 0">-</span></th>
                          <th style="border: 0.5px solid black; text-align: right; padding-right: 10px; font-weight: normal;"><span t-if="line.tongtien > 0" t-field="line.tongtien"/><span t-if="line.tongtien == 0">-</span></th>                        
                        </tr>
                      </t>
                      <tr>
                        <td style="border: 0.5px solid black; text-align: center; font-weight: bold;">Tổng cộng</td>
                        <td style="border: 0.5px solid black; text-align: right; padding-right: 10px; font-weight: bold;"></td>
                        <td style="border: 0.5px solid black; text-align: right; padding-right: 10px; font-weight: bold;"></td>
                        <td style="border: 0.5px solid black; text-align: right; padding-right: 10px; font-weight: bold;">                            
                          <span t-if=" sum(line.tongtien for line in o.reward_line_ids) > 0" t-esc="'{0:,.0f}'.format(sum(line.tongtien for line in o.reward_line_ids))"/><span t-if="sum(line.tongtien for line in o.reward_line_ids) == 0">-</span>                           
                        </td>                         
                      </tr>                      
                    </tbody>                    
                  </table>                  
                </div>
                
              </div>
              <!-- Report row content -->
            </t>
            <!-- Report footer content -->
          </div> <!-- page -->
        </t>
      </t>
    </template> 

</odoo>